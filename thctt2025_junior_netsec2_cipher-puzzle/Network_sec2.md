# ЁЯФР Network_sec2 тАФ Cipher Puzzle Chat

р╣Вр╕Ир╕Чр╕вр╣Мр╣Ар╕Щр╣Зр╕Хр╣Ар╕зр╕┤р╕гр╣Мр╕Бр╣Бр╕Щр╕зр╕Щр╣Ир╕▓р╕гр╕▒р╕Б: р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Кр╕Хр╣Гр╕Щр╕Юр╕╡р╣Бр╕Др╕Ыр╣Бр╕нр╕Ър╣Бр╕Щр╕Ър╕Кр╕┤р╣Йр╕Щр╕кр╣Ир╕зр╕Щр╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕к (hex) р╕бр╕▓р╣Гр╕лр╣Йр╣Ар╕гр╕▓р╕Хр╣Ир╕нр╣Бр╕ер╕░р╕Цр╕нр╕Фр╕гр╕лр╕▒р╕к ЁЯОп  
р╕Ыр╕ер╕▓р╕вр╕Чр╕▓р╕Зр╕Др╕╖р╕нр╕Ир╕Фр╕лр╕бр╕▓р╕вр╕Чр╕▒р╕Бр╕Чр╕▓р╕вр╣Бр╕ер╕░ **FLAG**

---

## ЁЯУБ р╣Др╕Яр╕ер╣Мр╣Вр╕Ир╕Чр╕вр╣М

| File | Size | SHA-256 |
|------|------|---------|
| `thctt2025_junior_netsec2_cipher-puzzle.pcapng` | 5480 bytes | `db1b1af4f059fce0144c114190ddacafa195fe976d12373a54c132759eb9085a` |

---

## тЪб TL;DR (р╕Чр╕│р╣Ар╕гр╣Зр╕з р╣Ар╕нр╕▓р╣Гр╕лр╣Йр╕Ир╕Ъ)

1) р╕Др╣Йр╕Щр╕кр╕Хр╕гр╕┤р╕Зр╣Гр╕Щ PCAP р╕Ир╕░р╣Ар╕Ир╕нр╕лр╕ер╕▓р╕вр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ `CIPHER_PART;part=N;data=<HEX>`  
2) р╣Ар╕гр╕╡р╕вр╕Зр╕Хр╕▓р╕б `part` р╣Бр╕ер╣Йр╕зр╣Бр╕Ыр╕ер╕З `HEX тЖТ bytes` р╕Хр╣Ир╕нр╕Бр╕▒р╕Щр╣Гр╕лр╣Йр╣Др╕Фр╣Й `ciphertext`  
3) р╕Цр╕нр╕Фр╣Бр╕Ър╕Ъ **repeatingтАСkey XOR** р╕Фр╣Йр╕зр╕вр╕Др╕╡р╕вр╣М `mango` тЖТ р╕Ир╕░р╣Др╕Фр╣Й plaintext р╣Ар╕Хр╣Зр╕б  
4) р╕нр╣Ир╕▓р╕Щр╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Чр╕╡р╣Ир╕бр╕╡ **flag**

**тЬЕ FLAG**
```
flag{50fba860c6c53436cbaffe8391619e67}
```

---

## ЁЯза р╣Др╕нр╣Ар╕Фр╕╡р╕в/р╕Бр╕▒р╕Ър╕Фр╕▒р╕Б (р╕кр╕гр╕╕р╕Ыр╕кр╕▒р╣Йр╕Щр╣Бр╕ер╕░р╕Хр╕гр╕Зр╕Ыр╕гр╕░р╣Ар╕Фр╣Зр╕Щ)

- р╕Ър╕Чр╕кр╕Щр╕Чр╕Щр╕▓р╣Гр╕Щр╕Юр╕╡р╣Бр╕Др╕Ы (р╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Чр╕╡р╣Ир╕Вр╕╢р╣Йр╕Щр╕Хр╣Йр╕Щр╕Фр╣Йр╕зр╕в `CHAT;msg=...`) р╣Ар╕Ыр╣Зр╕Щ **р╕Хр╕▒р╕зр╕лр╕ер╕нр╕Б**  
- р╕Вр╕нр╕Зр╕Ир╕гр╕┤р╕Зр╕Др╕╖р╕нр╕Ър╕гр╕гр╕Чр╕▒р╕Ф `CIPHER_PART;part=N;data=...` р╕Лр╕╢р╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щ **р╕Кр╕┤р╣Йр╕Щр╕кр╣Ир╕зр╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Рр╕▓р╕Щ 16**  
- р╣Ар╕бр╕╖р╣Ир╕нр╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Др╕гр╕Ъ р╕Ир╕░р╣Др╕Фр╣Йр╕Ър╕ер╣Зр╕нр╕Ър╕Чр╕╡р╣Ир╣Др╕бр╣Ир╣Др╕Фр╣Йр╕нр╣Ир╕▓р╕Щр╕Хр╕гр╕З р╣Ж (р╕бр╕╡р╣Др╕Ър╕Хр╣Мр╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 0x20 р╣Ар╕вр╕нр╕░) тЗТ р╕кр╣Ир╕нр╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щ **XOR cipher**  
- р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Фр╣Йр╕зр╕в **knownтАСplaintext attack** р╕кр╕бр╕бр╕╕р╕Хр╕┤р╕зр╣Ир╕▓р╕бр╕╡р╕Др╕│р╕зр╣Ир╕▓ `flag{` р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б тЖТ р╣Др╕ер╣Ир╕лр╕▓р╕Др╕╡р╕вр╣Мр╕Лр╣Йр╕│ тЖТ р╕Юр╕Ър╕зр╣Ир╕▓р╣Ар╕Ыр╣Зр╕Щ `mango`

---

## ЁЯкЬ Step-by-step (р╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Зр╣Ир╕▓р╕в)

### 1) р╕Фр╕╢р╕Зр╕Кр╕┤р╣Йр╕Щр╕кр╣Ир╕зр╕Щр╕Ир╕▓р╕Б PCAP
р╣Гр╕Кр╣Й `strings` р╕лр╕гр╕╖р╕нр╣Ар╕Ыр╕┤р╕Фр╣Гр╕Щ Wireshark р╣Бр╕ер╣Йр╕зр╕Др╣Йр╕Щр╕Др╕│р╕зр╣Ир╕▓ `CIPHER_PART` р╕Ир╕░р╣Ар╕лр╣Зр╕Щр╣Ар╕Кр╣Ир╕Щ:
```
CIPHER_PART;part=1;data=2504020b004d071c0e0a0305426d65210e00002c
...
CIPHER_PART;part=6;data=55525756595c580b5158106b
```

### 2) р╕гр╕зр╕бр╣Ар╕Ыр╣Зр╕Щ ciphertext
- р╣Ар╕гр╕╡р╕вр╕Зр╕Хр╕▓р╕бр╕лр╕бр╕▓р╕вр╣Ар╕ер╕В `part=1..6`
- р╕Хр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╕лр╕ер╕▒р╕З `data=` р╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕нр╕▒р╕Щ р╕Хр╣Ир╕нр╕Бр╕▒р╕Щ р╣Бр╕ер╣Йр╕з `hex тЖТ bytes`

### 3) р╕Цр╕нр╕Фр╕Фр╣Йр╕зр╕в repeatingтАСkey XOR
- р╣Гр╕Кр╣Йр╕Др╕╡р╕вр╣М `mango` (р╕Хр╕▒р╕зр╣Ар╕ер╣Зр╕Бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф)
- р╣Др╕Фр╣Йр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕▒р╕Бр╕Чр╕▓р╕вр╣Бр╕ер╕░р╕Ър╕гр╕гр╕Чр╕▒р╕Ф **FLAG**

р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З plaintext (р╕Ър╕▓р╕Зр╕кр╣Ир╕зр╕Щ):
```
Hello friend,

LongCat is here.
I have ... message for you. 

flag{50fba860c6c53436cbaffe8391619e67}
```

---

## ЁЯРН р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М Python (р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Й)

```python
#!/usr/bin/env python3
import re, binascii

pcap = "thctt2025_junior_netsec2_cipher-puzzle.pcapng"
buf = open(pcap, "rb").read()

parts = sorted(
    (int(m.group(1)), bytes.fromhex(m.group(2).decode()))
    for m in re.finditer(rb"CIPHER_PART;part=(\d+);data=([0-9A-Fa-f]+)", buf)
)

cipher = b"".join(b for _, b in parts)
key = b"mango"
plain = bytes(c ^ key[i % len(key)] for i, c in enumerate(cipher))
print(plain.decode(errors="replace"))
```

> р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Юр╕┤р╕кр╕╣р╕Ир╕Щр╣Мр╕Др╕╡р╕вр╣Мр╣Бр╕Ър╕Ър╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Фр╕▓ р╣Гр╕Кр╣Й **knownтАСplaintext**: р╕ер╕нр╕Зр╣Бр╕Чр╕Щр╕Чр╕╡р╣Ир╕Ър╕▓р╕Зр╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Фр╣Йр╕зр╕в `flag{` р╣Ар╕Юр╕╖р╣Ир╕нр╕Цр╕нр╕Фр╕Др╕╡р╕вр╣Мр╕Лр╣Йр╕│ р╣Бр╕ер╣Йр╕зр╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▒р╕Ър╕Чр╕▒р╣Йр╕Зр╕Ър╕ер╣Зр╕нр╕Ъ

---

## ЁЯЫбя╕П Disclaimer

> р╣Гр╕Кр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓/р╣Бр╕Вр╣Ир╕Зр╕Вр╕▒р╕Щ CTF р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ р╕лр╣Йр╕▓р╕бр╣Гр╕Кр╣Йр╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╕Ир╕гр╕┤р╕Зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕нр╕Щр╕╕р╕Нр╕▓р╕Х

---

## тЬи Author

**marioblox** тАФ *cipher tamer* ЁЯР▒тАНЁЯСд  
тАЬр╕Хр╣Ир╕нр╕Кр╕┤р╣Йр╕Щр╕кр╣Ир╕зр╕Щр╣Гр╕лр╣Йр╕Др╕гр╕Ъ р╣Бр╕ер╣Йр╕зр╕Др╣Ир╕нр╕вр╕Цр╕нр╕Фр╕Фр╣Йр╕зр╕вр╣Гр╕Ир╣Ар╕вр╣Зр╕Щ р╣ЖтАЭ
