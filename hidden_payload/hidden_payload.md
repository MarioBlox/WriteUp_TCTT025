# üíø Hidden Payload ISO ‚Äî Rijndael + PowerShell XOR

‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏≠‡∏¥‡∏°‡πÄ‡∏°‡∏à ISO9660/Joliet + Rock Ridge (ER) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ö‡πâ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à **AES‚Äë128** ‡πÅ‡∏•‡∏∞ payload ‡πÅ‡∏ö‡∏ö **PowerShell** üß©  
‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡πÑ‡∏•‡πà‡πÄ‡∏Å‡πá‡∏ö hint ‚Üí ‡∏ñ‡∏≠‡∏î AES‚ÄëECB ‚Üí ‡∏£‡∏±‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô XOR ‡∏ï‡∏≤‡∏°‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå ‚Üí ‡πÑ‡∏î‡πâ **FLAG**

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏à‡∏ó‡∏¢‡πå

| File | Size | SHA-256 |
|------|------|---------|
| `hidden_payload.iso` | 370688 bytes | `16429db3b0bdaa34b76dcf11072367d1133be0bd5407afa4fe4293aa46cb523c` |

---

## ‚ö° TL;DR (‡∏ó‡∏≥‡πÄ‡∏£‡πá‡∏ß ‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡∏à‡∏ö)

1) ‡∏≠‡πà‡∏≤‡∏ô Rock Ridge *Extension Record* (ER) ‡πÉ‡∏ô ISO ‚Üí ‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ö‡πâ:   `Rijndael key (128-bit) = ASCII 'J' repeated and hex-encoded`  ‚Üí ‡∏Ñ‡∏µ‡∏¢‡πå = `b"J"*16` (0x4A √ó 16)  
2) ‡∏û‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å **base64** (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏ã‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡πâ‡∏ô ‡πÜ ‡∏Ç‡∏≠‡∏á‡∏î‡∏¥‡∏™‡∏Å‡πå) ‚Üí ‡∏ñ‡∏≠‡∏î‡πÄ‡∏õ‡πá‡∏ô **AES‚ÄëECB ciphertext**  
3) ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏î‡πâ‡∏ß‡∏¢ **AES‚Äë128/ECB** (‡∏Ñ‡∏µ‡∏¢‡πå ‚ÄòJ‚Äô√ó16) ‚Üí ‡πÑ‡∏î‡πâ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå **PowerShell** ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®   `$data = @(0x.., 0x.., ...)` ‡πÅ‡∏•‡∏∞ `$key = 0x4A`  
4) ‡∏ó‡∏≥ **XOR** ‡πÑ‡∏ö‡∏ï‡πå‡πÉ‡∏ô `$data` ‡∏Å‡∏±‡∏ö `0x4A` ‚Üí ‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ **flag**

**‚úÖ FLAG**
```
flag{powershell_xor_hidden_so_easy}
```

---

## üß† ‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î)

- ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ISO ‡πÉ‡∏ä‡πâ Joliet/Rock Ridge; ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ö‡πâ‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÉ‡∏ô **Rock Ridge ER**  
- ciphertext ‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô **base64** ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (‡∏´‡∏ô‡∏∂‡πà‡∏á‚Äì‡∏™‡∏≠‡∏á‡πÄ‡∏ã‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô)  
- ‡∏ñ‡∏≠‡∏î base64 ‚Üí ‡πÑ‡∏î‡πâ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ AES‚Äë128 **ECB**; ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏Ñ‡∏∑‡∏≠ `'J'` √ó 16 ‡∏ï‡∏≤‡∏°‡πÉ‡∏ö‡πâ  
- plaintext ‡∏Ñ‡∏∑‡∏≠ PowerShell ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ `XOR` (`$key = 0x4A`) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á

---

## üêç ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏Ñ‡πâ‡∏ô + ‡∏ñ‡∏≠‡∏î + XOR)

```python
#!/usr/bin/env python3
import re, base64, pathlib
from Crypto.Cipher import AES

ISO = "hidden_payload.iso"
buf = pathlib.Path(ISO).read_bytes()

# 1) ‡∏£‡∏ß‡∏ö base64 ‡∏ä‡πà‡∏ß‡∏á‡∏¢‡∏≤‡∏ß ‡πÜ ‡πÉ‡∏ô‡∏≠‡∏¥‡∏°‡πÄ‡∏°‡∏à
b64_chunks = []
for m in re.finditer(rb"[A-Za-z0-9+/=](32,)", buf):
    s = m.group(0)
    try:
        base64.b64decode(s, validate=True)
        b64_chunks.append(s)
    except Exception:
        pass

# ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏õ‡πá‡∏ô ciphertext
b64_chunks.sort(key=len, reverse=True)
cipher = base64.b64decode(b64_chunks[0])

# 2) ‡∏ñ‡∏≠‡∏î AES-128 ECB (key = 'J' * 16)
key = b"J" * 16
plain = AES.new(key, AES.MODE_ECB).decrypt(cipher)

# 3) ‡∏î‡∏∂‡∏á‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå PowerShell: $data = @(0x.., 0x.., ...); $key = 0x4A
m = re.search(rb"\$data\s*=\s*@\((0x[0-9A-Fa-f]2(?:\s*,\s*0x[0-9A-Fa-f]2)*)\).*?\$key\s*=\s*0x([0-9A-Fa-f]{2})", plain, re.S)
hex_list = m.group(1).decode()
xorkey = int(m.group(2), 16)

arr = [int(x,16) for x in re.findall(r"0x([0-9A-Fa-f]{2})", hex_list)]
out = bytes(b ^ xorkey for b in arr).decode("utf-8", errors="replace")
print(out)
```

> ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ñ‡πâ‡∏≤ base64 ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏´‡∏•‡∏≤‡∏¢‡∏Å‡πâ‡∏≠‡∏ô ‡πÉ‡∏´‡πâ stitch ‡∏ä‡∏¥‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô/‡πÉ‡∏ô‡πÄ‡∏ã‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏Å‡∏•‡πâ ‡πÜ ‡∏Å‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡∏ñ‡∏≠‡∏î

---

## üõ°Ô∏è Disclaimer

> ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô CTF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï

---

## ‚ú® Author

**marioblox** ‚Äî *disk sneaky hunter* üêæ  
‚Äú‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏°‡∏ó‡∏≤‡∏î‡∏≤‡∏ó‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏≠‡∏î crypto ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‚Äù
