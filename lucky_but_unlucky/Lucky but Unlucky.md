# üçÄ Lucky but Unlucky ‚Äî Remote MT19937 & Logic Gates (Auto Solver)

‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏£‡∏µ‡πÇ‡∏°‡∏ï‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á ‚Äú‡∏ó‡∏≤‡∏¢‚Äù ‡∏Ñ‡πà‡∏≤ **Lucky/X** ‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö **FLAG**  
‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î: **‡∏î‡∏π‡∏î 624 ‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï‡∏Ç‡∏≠‡∏á MT19937**, **untemper** ‡∏™‡∏£‡πâ‡∏≤‡∏á state, **‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏Ñ‡∏π‡πà‡∏ñ‡∏±‡∏î‡πÑ‡∏õ**, ‡πÅ‡∏•‡∏∞ **‡∏õ‡πâ‡∏≠‡∏ô‡∏≠‡∏¥‡∏ô‡∏û‡∏∏‡∏ï‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ú‡πà‡∏≤‡∏ô** ‚Äî ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏≠ RTT

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

| File | Size | SHA-256 |
|------|------|---------|
| `lucky_but_unlucky.py` | 1502 bytes | `824507cd5acc3dbea650ff827e44e5638206b9152a76cbba5f9eb9e5c20ca620` |

> ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Python 3.9+ (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πÄ‡∏™‡∏£‡∏¥‡∏°), ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á `110.164.135.99:10002`

---

## ‚ö° ‡∏£‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏à‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

```bash
python3 lucky_but_unlucky.py
```
‡∏ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå flag ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `flag{...}` ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏™‡∏ä‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á):**
```
flag{<server_generated_value>}
```

> ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: **Flag ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å** (‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏™‡∏ï‡∏£‡∏µ‡∏° MT ‡∏Ç‡∏≠‡∏á‡∏£‡∏≠‡∏ö‡∏ô‡∏±‡πâ‡∏ô) ‡∏à‡∏∂‡∏á‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô

---

## üß† ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô)

1) **‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏≠‡∏≤‡∏ï‡πå‡∏û‡∏∏‡∏ï 624 ‡∏Ñ‡πà‡∏≤**  
   ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏à‡∏∞‡∏™‡πà‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏±‡∏ô‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ `Lucky #<u32>` ‡πÅ‡∏•‡∏∞ `Exit #<u32>` ‚Üí ‡∏£‡∏ß‡∏° 312 ‡∏Ñ‡∏π‡πà = 624 ‡∏Ñ‡πà‡∏≤  
   ‡πÉ‡∏ä‡πâ regex ‡πÅ‡∏ö‡∏ö incremental (`select` + `finditer` ‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏°) ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï

2) **Untemper MT19937 ‚Üí seed state**  
   ‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô temper (`>>18`, `<<15 & C`, `<<7 & B`, `>>11`) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏π‡πâ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô state ‡∏ó‡∏±‡πâ‡∏á 624 ‡∏ä‡πà‡∏≠‡∏á ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô seed ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß **‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢** ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 313 (`lucky_313`, `x_313`).

3) **‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô string-logic**  
   ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ `s.replace("lucky"+x, "") == "lucky"+x` ‡∏à‡∏∂‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏ö
   ```text
   s = "lu" + "lucky{X}" + "cky{X}"
   ```
   ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏ö `"lucky{X}"` ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠ `"lu" + "cky{X}"` = `"lucky{X}"` ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

4) **‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô numeric/hash**  
   - ‡∏™‡πà‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ `int(b) != int(c)` ‡πÅ‡∏ï‡πà `float(b) == float(c)` ‚Üí ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡∏ç‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö 2^64 ‡∏ó‡∏µ‡πà **float** ‡∏õ‡∏±‡∏î‡πÑ‡∏õ‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô  
   - ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå **collision ‡∏ö‡∏ô `hash(int)` ‡∏Ç‡∏≠‡∏á CPython 64-bit**: ‡∏™‡∏£‡πâ‡∏≤‡∏á `H` ‡πÉ‡∏´‡πâ `hash(H) == (lucky_313 % 10000)+1` ‡πÅ‡∏°‡πâ `H != ...`  
   - ‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏õ‡πá‡∏ô **‡πÄ‡∏•‡∏Ç‡∏≠‡∏≤‡∏£‡∏ö‡∏¥‡∏Å‚Äë‡∏Æ‡∏¥‡∏ô‡∏î‡∏π (Arabic‚ÄëIndic)** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏£‡∏ß‡∏à `int()` ‡∏Ç‡∏≠‡∏á Python ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥

5) **‡∏û‡πà‡∏ô payload ‡πÅ‡∏ö‡∏ö pipeline ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß** (‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏£‡∏≠‡∏ö) ‚Üí ‡∏≠‡πà‡∏≤‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏ô‡πÄ‡∏à‡∏≠ `flag{...}` ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

---

## ü™ú ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡πà‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏ï‡∏±‡∏î‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏î‡∏π)

```python
# untemper & MT19937 state rebuild
def untemper(y): ...
class MT19937: ...
observed=[v for pair in zip(ls,xs) for v in pair]  # 624 ‡∏Ñ‡πà‡∏≤
state=[untemper(y) for y in observed]
mt=MT19937(); mt.seed_with_state(state)
lucky_313=mt.rand_32(); x_313=mt.rand_32()

# bypass replace-trick
def build_name(x): return "lu"+"lucky"+x+"cky"+x

# craft hashes & unicode-digits
def h_for(i): return (1<<64) + (i - 8)
def to_ai(n): ...
```

---

## üõ°Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á/‡∏ó‡∏£‡∏¥‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£

- ‡∏´‡∏≤‡∏Å‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏ô‡πà‡∏ß‡∏á ‡πÄ‡∏û‡∏¥‡πà‡∏° `deadline` ‡πÄ‡∏õ‡πá‡∏ô 60‚Äì90s ‡πÑ‡∏î‡πâ
- ‡∏ñ‡πâ‡∏≤‡πÅ‡∏û‡∏ó‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö regex `R = r"(Exit #d+)|(Lucky #d+)"` ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á
- ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `TCP_NODELAY` ‡πÅ‡∏•‡∏∞ non‚Äëblocking I/O ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á RTT; ‡∏´‡∏≤‡∏Å‡∏ü‡∏≤‡∏ß‡∏•‡πå‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏°‡∏î‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß

---

## ‚úÖ FLAG

> ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö **flag ‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á** (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå)
> 
> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô:
> ```
> flag{...}
> ```

---

## ‚ú® Author

**marioblox** ‚Äî *PRNG whisperer* üé≤  
‚Äú‡πÄ‡∏´‡πá‡∏ô 624 ‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏£ ‚Äî MT ‡∏Å‡πá‡πÑ‡∏£‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‚Äù
