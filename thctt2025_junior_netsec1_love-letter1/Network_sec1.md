# üß© Network_sec1 ‚Äî Love Letter in the Packets

‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Å (‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô) ‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô ‚Äú‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏±‡∏Å‚Äù ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏£‡∏≤‡∏ü‡∏ü‡∏¥‡∏Å `pcapng` ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏¢‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏ô‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡πà‡∏≤‡∏ô Flag

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏à‡∏ó‡∏¢‡πå

| File | Size | SHA-256 |
|------|------|---------|
| `thctt2025_junior_netsec1_love-letter1.pcapng` | 8,823 bytes | `5952c5ef66faaa9b0ab519af23d11af186c23ce2ba473cb7f2203b66ea8fe07e` |

---

## ‚ö° TL;DR (‡∏ó‡∏≥‡πÄ‡∏£‡πá‡∏ß ‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡∏à‡∏ö)

```bash
# 1) ‡∏î‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô Base64 (‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç part)
strings -n 8 thctt2025_junior_netsec1_love-letter1.pcapng | grep 'BLOCK_UPDATE;id=chair;part=' | sort -t= -k2,2n | sed 's/.*data=//g' | tr -d '\n' > payload.b64

# 2) ‡∏ñ‡∏≠‡∏î Base64 ‚Üí ‡πÑ‡∏î‡πâ ZIP
base64 -d payload.b64 > payload.zip

# 3) ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô ZIP
unzip -p payload.zip love_letter.txt
```

**‚úÖ Flag**
```
flag{f0b3e7e3568616fa6d4a22ad0ed4c89e}
```

---

## üß† ‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏´‡∏•‡∏±‡∏Å (‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô)

- ‡πÉ‡∏ô‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡∏°‡∏µ‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏±‡∏ô:
  ```
  BLOCK_UPDATE;id=chair;part=<N>;data=<BASE64>
  ```
- ‡∏ü‡∏¥‡∏•‡∏î‡πå `data=` ‡∏Ñ‡∏∑‡∏≠ **Base64** ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å ‚Äú‡∏´‡∏±‡πà‡∏ô‚Äù ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏¥‡πâ‡∏ô (part=1..11)  
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ñ‡∏π‡∏Å‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏≠‡∏î Base64 ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏ü‡∏•‡πå **ZIP** ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ `love_letter.txt` ‡∏ã‡πà‡∏≠‡∏ô Flag ‡∏≠‡∏¢‡∏π‡πà

> ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ï‡πâ‡∏ô‡∏™‡∏ï‡∏£‡∏¥‡∏á Base64 ‡∏°‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô `UEs...` (‡∏Ñ‡∏∑‡∏≠ ‚ÄúPK‚Äù ‡∏Ç‡∏≠‡∏á ZIP)

---

## ü™ú Step-by-step (‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢)

### 1) ‡∏Ñ‡πâ‡∏ô‡πÄ‡∏ö‡∏≤‡∏∞‡πÅ‡∏™‡πÉ‡∏ô pcap
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô **Wireshark** ‚Üí `Ctrl+F` ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **String** + **Packet bytes**  
- ‡∏Ñ‡πâ‡∏ô‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ `BLOCK_UPDATE` ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:
  ```
  BLOCK_UPDATE;id=chair;part=1;data=UEsDBBQAAAAI...
  BLOCK_UPDATE;id=chair;part=2;data=RZFBb9s...
  ...
  BLOCK_UPDATE;id=chair;part=11;data=bG92ZV9sZXR0ZXIudHh0UEsFBg...
  ```

### 2) ‡∏£‡∏ß‡∏° Base64 ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö part
- ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á `data=` ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï
- **‡πÄ‡∏£‡∏µ‡∏¢‡∏á** ‡∏ï‡∏≤‡∏° `part=1 ‚Üí part=N`
- ‡∏ô‡∏≥‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‚Üí `payload.b64`

### 3) ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå
```bash
base64 -d payload.b64 > payload.zip
unzip -l payload.zip
unzip -p payload.zip love_letter.txt
```
‡∏à‡∏∞‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‡∏û‡∏£‡πâ‡∏≠‡∏° **Flag** ‡∏ï‡∏≠‡∏ô‡∏ó‡πâ‡∏≤‡∏¢

---

## üß∞ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

- **Wireshark** ‚Äî ‡∏Ñ‡πâ‡∏ô‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï/‡∏™‡∏ï‡∏£‡∏¥‡∏á
- **CLI** ‚Äî `strings`, `grep`, `sort`, `sed`, `base64`, `unzip`
- **CyberChef** ‚Äî ‚ÄúFrom Base64‚Äù ‚Üí ‚ÄúExtract Files‚Äù (‡∏•‡∏≤‡∏Å Base64 ‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ)

---

## üêç ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå Python (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏£‡∏¥‡∏°)

```python
import re, base64, io, zipfile

pcap = "thctt2025_junior_netsec1_love-letter1.pcapng"
raw = open(pcap, "rb").read()

parts = sorted(
    (int(m.group(1)), m.group(2).decode())
    for m in re.finditer(rb"BLOCK_UPDATE;id=chair;part=(\d+);data=([A-Za-z0-9+/=]+)", raw)
)

b64 = "".join(b for _, b in parts)
zip_bytes = base64.b64decode(b64)
with zipfile.ZipFile(io.BytesIO(zip_bytes)) as z:
    print(z.read("love_letter.txt").decode())
```

---

## üìù ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡πâ‡∏ô‡πÜ

- ‡πÄ‡∏´‡πá‡∏ô Base64 ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô `UEs` ‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á ZIP (`PK`)
- ‡πÇ‡∏à‡∏ó‡∏¢‡πå Forensics ‡∏ä‡∏≠‡∏ö ‚Äú‡∏ã‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÜ‚Äù ‡πÉ‡∏ô‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï ‚Üí ‡∏ï‡πâ‡∏≠‡∏á **‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö** ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏≠‡∏î
- CLI ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á (‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏ã‡πâ‡∏≥‡∏á‡πà‡∏≤‡∏¢)

---

## üõ°Ô∏è Disclaimer

> ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤/‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô CTF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡∏ô‡∏≥‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï

---

## ‚ú® Author

**marioblox** ‚Äî *packet whisperer*  
‚Äú‡∏à‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏≤ Flag ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏≠‡∏á‚Äù
